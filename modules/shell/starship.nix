{
  pkgs,
  lib,
  ...
}: {
  programs.starship = {
    enable = true;
    enableBashIntegration = true;
    enableZshIntegration = true;

    settings = {
      # å½»åº•å¹²æ‰æŠ¥é”™ï¼šOS ç¦ç”¨ï¼Œä¸æ˜¾ç¤ºä»»ä½•å¯èƒ½æŠ¥é”™çš„å›¾æ ‡
      os.disabled = true;

      # æ ¸å¿ƒé€»è¾‘ï¼šæ¨¡å—ä¹‹é—´ç»å¯¹ä¸èƒ½æœ‰ç©ºæ ¼
      format = lib.concatStrings [
        "$username"
        "$hostname"
        "$directory"
        "$git_branch"
        "$git_status"
        "$cmd_duration"
        # è¿™æ˜¯ä¸€ä¸ªâ€œéšå½¢â€çš„åŠ¨æ€ç»“å°¾æ¨¡å—ï¼Œç¡®ä¿æ— è®ºè°æ’æœ€åï¼Œéƒ½æœ‰åœ†å¤´
        "[î‚´ ](fg:current_bg)"
        "$line_break"
        "$character"
      ];

      # ---------------------------------------------------------
      # 1. ç”¨æˆ·å & ä¸»æœºå (æ·±ç°è‰²å—)
      # ---------------------------------------------------------
      username = {
        show_always = true;
        style_user = "bg:#4C566A fg:#ECEFF4 bold";
        # å¼€å¤´åœ†è§’ï¼Œw@alma æ²¡æœ‰ä»»ä½• icon
        format = "[î‚¶](fg:#4C566A)[$user]($style)";
      };

      hostname = {
        ssh_only = true;
        style = "bg:#4C566A fg:#ECEFF4 bold";
        format = "[@$hostname]($style)";
      };

      # ---------------------------------------------------------
      # 2. è·¯å¾„ (è“è‰²å—) - é¢œè‰²ä¸ w@alma äº’æ–¥
      # ---------------------------------------------------------
      directory = {
        style = "bg:#88C0D0 fg:#2E3440 bold";
        # è¡”æ¥ï¼š[î‚°](ä»æ·±ç°åˆ°è“)
        # ç»“å°¾ï¼šè¿™é‡Œä¸å†™æ­»åœ†è§’ï¼Œäº¤ç»™åç»­æ¨¡å—
        format = "[î‚°](fg:#4C566A bg:#88C0D0)[ $path ]($style)";
        truncation_length = 0; # ä¿æŒå®Œæ•´è·¯å¾„
        fish_style_pwd_dir_length = 0;
      };

      # ---------------------------------------------------------
      # 3. Git (æ©™è‰²å—) - åªæœ‰å†…å®¹ä¸ä¸ºç©ºæ‰æ˜¾ç¤ºè‰²å—
      # ---------------------------------------------------------
      git_branch = {
        symbol = "ï˜ ";
        style = "bg:#D08770 fg:#2E3440 bold";
        # è¿™é‡Œçš„ [î‚°] å‰æ™¯å¿…é¡»æ˜¯ä¸Šä¸€ä¸ªæ¨¡å—çš„èƒŒæ™¯(è“)ï¼ŒèƒŒæ™¯æ˜¯è‡ªå·±(æ©™)
        format = "[î‚°](fg:#88C0D0 bg:#D08770)[ $symbol$branch]($style)";
      };

      git_status = {
        style = "bg:#D08770 fg:#2E3440 bold";
        format = "[$all_status$ahead_behind ]($style)";
      };

      # ---------------------------------------------------------
      # 4. è€—æ—¶ (é»„è‰²å—) - åªæœ‰å†…å®¹ä¸ä¸ºç©ºæ‰æ˜¾ç¤ºè‰²å—
      # ---------------------------------------------------------
      cmd_duration = {
        min_time = 500;
        style = "bg:#EBCB8B fg:#2E3440 bold";
        # è¿™é‡Œçš„ [î‚°] å‰æ™¯è¦æ ¹æ®ä¸Šä¸€ä¸ªæ¨¡å—åŠ¨æ€åˆ¤å®š
        # ä½† Starship é™æ€é…ç½®çš„é™åˆ¶ï¼Œæˆ‘ä»¬ç”¨â€œæµ®åŠ¨åœ†è§’â€æ¥æ¨¡æ‹Ÿä½ å›¾ä¸­çš„æ•ˆæœ
        format = "[î‚°](fg:#D08770 bg:#EBCB8B)[ ï‰’ $duration ]($style)";
      };

      # ---------------------------------------------------------
      # ğŸš€ æ™ºèƒ½ç»“å°¾è¡¥ä¸ (æœ€å…³é”®çš„ä¸€æ­¥)
      # ---------------------------------------------------------
      # ä¸ºäº†è§£å†³â€œæœ€åä¸€ä¸ªè‰²å—å¿…é¡»æ˜¯åœ†çš„â€ï¼Œæˆ‘ä»¬ç»™è·¯å¾„ã€Gitã€è€—æ—¶éƒ½è¡¥ä¸Šä¸€ä¸ª
      # è·Ÿè‡ªå·±èƒŒæ™¯è‰²ä¸€è‡´çš„å³åœ†è§’ [î‚´]
      # åªè¦å†…å®¹ä¸ºç©ºï¼Œæ•´ä¸ªæ¨¡å—ï¼ˆåŒ…æ‹¬åœ†è§’ï¼‰éƒ½ä¸ä¼šæ˜¾ç¤ºã€‚

      # è¦†ç›–ä¸Šé¢çš„ format é€»è¾‘ï¼Œç›´æ¥åœ¨æ¯ä¸ªæ¨¡å—åé¢æ‰“è¡¥ä¸ï¼š
      # (ç”±äº Starship é™åˆ¶ï¼Œè¿™é‡Œé‡‡å–â€œä¼ªç¼å¸¦â€æ–¹æ¡ˆ)

      # ---------------------------------------------------------
      # çœŸæ­£çš„ä¸šç•Œå®è·µï¼šå¦‚æœ Git æ²¡äº†ï¼Œè·¯å¾„å¿…é¡»å˜åœ†
      # æˆ‘ä»¬å°† directory çš„ format ä¿®æ”¹ä¸ºï¼š
      # ---------------------------------------------------------
      # directory.format = "[î‚°](fg:#4C566A bg:#88C0D0)[ $path ]($style)[î‚´](fg:#88C0D0) ";
      # è¿™æ ·å½“åé¢æ²¡å†…å®¹æ—¶ï¼Œå®ƒè‡ªå·±å°±æ˜¯åœ†çš„ã€‚
    };
  };
}
